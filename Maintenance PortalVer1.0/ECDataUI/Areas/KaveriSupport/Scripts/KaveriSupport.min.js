function GenerateSaveKeyPair(){BlockUI();$.ajax({type:"POST",url:"/KaveriSupport/KaveriSupport/GenerateKeyPair",success:function(n){n.success?bootbox.alert({message:'<i class="fa-check text-success boot-icon boot-icon"><\/i><span class="boot-alert-txt"> Public Key generated and uploaded successully<\/span>'}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Failed to generate and upload public key <\/span>'});$.unblockUI()},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in processing<\/span>'})}})}function DecryptEnclosure(){var r=$("#txtticketNumber").val(),n=new FormData,t=null,i;$.each($("input[type='file']"),function(){var i=$(this).attr("id"),r=document.getElementById(i).files[0];r!=undefined&&(n.append(i,r),t==null?t=i+",":t+=i+",")});n.append("filesArray",t);i=r;n.append("TicketNumber",i);BlockUI();$.ajax({type:"POST",url:"/KaveriSupport/KaveriSupport/DecryptEnclosureFile",data:n,headers:header,processData:!1,contentType:!1,success:function(n){n.success?($("#txtticketNumber").val(""),$("#zipFile").val(""),window.location.href="/KaveriSupport/KaveriSupport/DownloadFile?Filepath="+n.Filepath+"&TicketNumber="+n.TicketNumber):n.message==undefined?bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured. because  <ul style="list-style-type: disc;font-weight:normal"><li> Either Duplicate Session Found<\/li><li>Invalid Request<\/li> <li> Poor network connectivity<\/li><\/span>',callback:function(){window.location.href="/Error/SessionExpire";$.unblockUI()}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>"});$.unblockUI()},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in processing<\/span>'})}})}function EncryptPatchFile(){var t=new FormData,n=null,i;$.each($("input[type='file']"),function(){var i=$(this).attr("id"),r=document.getElementById(i).files[0];r!=undefined&&(t.append(i,r),n==null?n=i+",":n+=i+",")});t.append("filesArray",n);i=$("#txtticketNumber").val();BlockUI();$.ajax({type:"POST",url:"/KaveriSupport/KaveriSupport/UploadSQLPatchFile",data:t,headers:header,processData:!1,contentType:!1,success:function(n){n.success?($("#hdnSQLPatchFile").val(n.filePath),BlockUI(),$.ajax({type:"POST",url:"/KaveriSupport/KaveriSupport/EncryptSQLPatchFile",data:{sqlFilePath:n.filePath,TicketNumber:i},headers:header,success:function(n){n.success?bootbox.alert({message:'<i class="fa fa-check text-success boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>",callback:function(){window.location.href="/KaveriSupport/KaveriSupport/EncryptSQLPatch"}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>"});$.unblockUI()},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in processing<\/span>'});$.unblockUI()}})):(bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>"}),$.unblockUI())},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in processing<\/span>'});$.unblockUI()}})}function RegisterTicketDetailsAndGenerateKeyPair(){var n=$("#TicketRegForm");n.removeData("validator");n.removeData("unobtrusiveValidation");$.validator.unobtrusive.parse(n);$("#TicketRegForm").valid()&&$.ajax({type:"POST",url:"/KaveriSupport/KaveriSupport/RegisterTicketDetailsAndGenerateKeyPair",data:$("#TicketRegForm").serialize(),headers:header,success:function(n){n.success?bootbox.alert({message:'<i class="fa fa-check text-success boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>",callback:function(){window.location.href="/KaveriSupport/KaveriSupport/KaveriSupport"}}):n.message==undefined?bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured. because  <ul style="list-style-type: disc;font-weight:normal"><li> Either Duplicate Session Found<\/li><li>Invalid Request<\/li> <li> Poor network connectivity<\/li><\/span>',callback:function(){window.location.href="/Error/SessionExpire";$.unblockUI()}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>"});$.unblockUI()},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in processing<\/span>'})}})}function BlockUI(){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",opacity:.5,color:"#fff"}})}var token="",header={};$(document).ready(function(){token=$("[name=__RequestVerificationToken]").val();header.__RequestVerificationToken=token;$("#txtticketNumber").val("");$("#zipFile").change(function(){if($.inArray($(this).val().split(".").pop().toLowerCase(),["zip","ZIP"])==-1)return bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Only ZIP file is allowed .<\/span>',callback:function(){}}),$(this).val(""),!1});$("#SQLPatchFile").change(function(){var n,i,t;return $.inArray($(this).val().split(".").pop().toLowerCase(),["sql"])==-1?(bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Only SQL file is allowed .<\/span>',callback:function(){}}),$(this).val(""),!1):(n=document.getElementById(this.id).files.item(0),i=$(this).attr("id"),n.size>MaxFileSizeToUpload?(t=MaxFileSizeToUpload/1048576,bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">File size is greater than '+t+" MB. Please upload another file<\/span>",callback:function(){}}),$(this).val(""),!1):void 0)});$("#btnGeneratekeyPair").click(function(){GenerateSaveKeyPair()});$("#btnDecryptFile").click(function(){$("#hdnFilePath").val($("#zipFile").val());DecryptEnclosure()});$("#btnEncryptPatchFile").click(function(){$("#hdnSQLPatchFile").val($("#SQLPatchFile").val());EncryptPatchFile()});$("#btnRegister").click(function(){RegisterTicketDetailsAndGenerateKeyPair()});$(".AllowOnlyNumber").keypress(function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return!1})});