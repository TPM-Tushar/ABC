var FromDate,ToDate,SROOfficeListID,DROfficeID,token="",header={},SelectedDistrict,SelectedSRO;$(document).ready(function(){token=$("[name=__RequestVerificationToken]").val();header.__RequestVerificationToken=token;$("#DROOfficeListID").focus();$(".AllowOnlyNumber").keypress(function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return!1});$("#txtFromDate").datepicker({autoclose:!0,format:"dd/mm/yyyy",endDate:"+0d",maxDate:"0",pickerPosition:"bottom-left"});$("#txtToDate").datepicker({autoclose:!0,format:"dd/mm/yyyy",endDate:"+0d",maxDate:"0",pickerPosition:"bottom-left"});$("#divFromDate").datepicker({autoclose:!0,format:"dd/mm/yyyy",endDate:"+0d",maxDate:new Date,pickerPosition:"bottom-left"});$("#divToDate").datepicker({autoclose:!0,format:"dd/mm/yyyy",endDate:"+0d",maxDate:new Date,pickerPosition:"bottom-left"});$("#txtToDate").datepicker({format:"dd/mm/yyyy"}).datepicker("setDate",ToDate);$("#txtFromDate").datepicker({format:"dd/mm/yyyy",changeMonth:!0,changeYear:!0}).datepicker("setDate",FromDate);$("#DtlsSearchParaListCollapse").click(function(){var n=$("#DtlsToggleIconSearchPara").attr("class"),t=n=="fa fa-plus-square-o fa-pull-left fa-2x"?"fa fa-minus-square-o fa-pull-left fa-2x":"fa fa-plus-square-o fa-pull-left fa-2x";$("#DtlsToggleIconSearchPara").removeClass(n).addClass(t)});$("#DROOfficeListID").change(function(){blockUI("loading data.. please wait...");$.ajax({url:"/MISReports/SRODocCashCollection/GetSROOfficeListByDistrictID",data:{DistrictID:$("#DROOfficeListID").val()},datatype:"json",type:"GET",success:function(n){n.serverError==!0?bootbox.alert('<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.errorMessage+"<\/span>",function(){window.location.href="/Home/HomePage"}):($("#SROOfficeListID").empty(),$.each(n.SROOfficeList,function(n,t){t;$("#SROOfficeListID").append('<option value="'+t.Value+'">'+t.Text+"<\/option>")}));unBlockUI()},error:function(){unBlockUI()}})});var n=$("#SROOfficeListID option:selected").val(),t=$("#DROOfficeListID option:selected").val();$("#excelDownload").click(function(){FromDate=$("#txtFromDate").val();ToDate=$("#txtToDate").val();n=$("#SROOfficeListID option:selected").val();DROfficeID=$("#DROOfficeListID option:selected").val();SelectedDistrict=$("#DROOfficeListID option:selected").text();SelectedSRO=$("#SROOfficeListID option:selected").text();blockUI("loading data.. please wait...");$.ajax({url:"/MISReports/SRODocCashCollection/ValidateSearchParameters",data:{fromDate:FromDate,ToDate:ToDate,SROOfficeListID:n,DROfficeID:DROfficeID},type:"GET",success:function(t){t.success==!0?(window.location.href="/MISReports/SRODocCashCollection/ExportToExcel?FromDate="+FromDate+"&ToDate="+ToDate+"&SROOfficeListID="+n+"&DROfficeID="+DROfficeID+"&SelectedDistrict="+SelectedDistrict+"&SelectedSRO="+SelectedSRO,unBlockUI()):(unBlockUI(),bootbox.alert('<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+t.errorMessage+"<\/span>",function(){}))},error:function(){unBlockUI()}})})});