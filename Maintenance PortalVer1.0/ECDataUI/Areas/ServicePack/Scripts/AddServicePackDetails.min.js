function AddServicePackDetails(){var n,t,e,i,r,u,f;if($("#lstReleaseTypes").val()==0){bootbox.alert("Please Select Release Type");return}if($("#onlyMajorNumber").val()==""){bootbox.alert("Major Version is needed");return}if($("#onlyMinorNumber").val()==""){bootbox.alert("Minor Version is needed");return}if($("#txtServicePackDesc").val()==""){bootbox.alert("Service Pack Description is needed");return}if($("#txtInstallationProcedure").val()==""){bootbox.alert("Installation Procedure is needed");return}if(n=new FormData,t=document.getElementById("UploadReleaseFile").files[0],t==null){bootbox.alert("Please upload Release File");return}if(FileSizeForValidation>150){bootbox.alert("Please Upload file size less than 150 MB!");return}e=new RegExp("^[a-zA-Z0-9-/., ]+$");n.append("ReleaseType",$("#lstReleaseTypes").val());n.append("File",t);n.append("Major",$("#onlyMajorNumber").val());n.append("Minor",$("#onlyMinorNumber").val());n.append("ChangesType",$("#lstChangeType").val());n.append("FinalTestValue",$('[name="ServicePackDetails.IsTestOrFinal"]:checked').val());n.append("ServicePackDescription",$("#txtServicePackDesc").val());n.append("InstallationProcedure",$("#txtInstallationProcedure").val());i=bugsList.join("|");n.append("BugsList",i);r=enhancementsList.join("|");n.append("EnhancementList",r);u=SuuportAnalysisList.join("|");n.append("SupportAnalysisList",u);f=$("[name=__RequestVerificationToken]").val();n.append("__RequestVerificationToken",f);$.ajax({url:"/ServicePack/ServicePackDetails/SaveServicePackDetails",type:"POST",data:n,contentType:!1,processData:!1,success:function(n){n.serverError==!0&&n.success==!1?(n.message!=null||n.message!="")&&bootbox.alert({message:n.message,callback:function(){window.location.href="/Home/HomePage"}}):n.success?bootbox.alert({message:n.message,callback:function(){window.location.href="/ServicePack/ServicePackDetails/AddServicePackDetailsHome"}}):n.success==!1&&bootbox.alert(n.message)},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error in Processing<\/span>'})}})}function DownloadServicePack(n){window.location.href="/ServicePack/ServicePackDetails/DownloadServicePackFile?virtualPath="+n}function EditServicePackDetails(n){window.location.href="/ServicePack/ServicePackDetails/EditServicePackDetails?id="+n}var bugsList=[],enhancementsList=[],SuuportAnalysisList=[],enhancementsFixedBugsInputRules=/^[a-zA-Z0-9-/., ]+$/,majorversionInput=new RegExp("^(?:[1-9] | 0[1-9]|10)$"),minorversionInput=new RegExp("^(?:[1-9]|1[1-9]|20)$"),changesModificationslist='<select id=\'abc\'><option value="1">Bug<\/option><option value="2">Enhancements<\/option><\/select>',FileSizeForValidation=0;$(document).ready(function(){$(".ClsServicePackReleaseFiles").change(function(){var i,t,n;if($("span.spnClear").hide(),i=["zip","ZIP"],$.inArray($(this).val().split(".").pop().toLowerCase(),i)==-1)return bootbox.alert("Only Zip Files Are Allowed!!"),$(this).val(""),$("span.spnClear").hide(),!1;t=document.getElementById(this.id).files.item(0);n=t.size/1048576;n=n.toFixed(2);$("span.spnClear").show();$("#FileSize").addClass("fa fa-file");n==0?(n=t.size/1024,$("#spn").text("File Size: "+n.toFixed(2)+" KB    ")):$("#spn").text("File Size: "+n+" MB    ");FileSizeForValidation=n;$("#divFileSize").show()});$('[data-toggle="tooltip"]').tooltip();var n=$("table td:last-child").html();$(".add-new").click(function(){$(this).attr("disabled","disabled");var i=$("table tbody tr:last-child").index(),t='<tr><td style="word-wrap: anywhere;"><input type="text" class="form-control" name="name" id="name"><\/td><td>'+n+"<\/td><\/tr>";$("table").append(t);$('[data-toggle="tooltip"]').tooltip()});$(document).on("click",".add",function(){var t=!1,n=$(this).parents("tr").find('input[type="text"]');if($("#lstChangeType").val()==0){bootbox.alert("Please Select Correspoding Modification Type to continue");return}if(!n.val().trim()){bootbox.alert("Please enter Changes/Modification type description");return}if(enhancementsFixedBugsInputRules.test(n.val()))$("#lstChangeType").val()==1&&bugsList.push(n.val()),$("#lstChangeType").val()==2&&enhancementsList.push(n.val()),$("#lstChangeType").val()==3&&SuuportAnalysisList.push(n.val());else{bootbox.alert("Invalid Input");return}n.each(function(){$(this).val()?$(this).removeClass("error"):($(this).addClass("error"),t=!0)});$(this).parents("tr").find(".error").first().focus();t||$("#lstChangeType").val()!="2"?t||$("#lstChangeType").val()!="1"?t||$("#lstChangeType").val()!="3"||(n.each(function(){$(this).parent("td").html("<label style='color:blue;word-break:break-word;'>Support Analysis : <\/label>"+$(this).val())}),$(this).parents("tr").find(".add, .edit").toggle(),$(".add-new").removeAttr("disabled")):(n.each(function(){$(this).parent("td").html("<label style='color:red;word-break:break-word;'>Bug : <\/label>"+$(this).val())}),$(this).parents("tr").find(".add, .edit").toggle(),$(".add-new").removeAttr("disabled")):(n.each(function(){$(this).parent("td").html("<label style='color:green;word-break:break-word;'>Enhancement : <\/label>"+$(this).val())}),$(this).parents("tr").find(".add, .edit").toggle(),$(".add-new").removeAttr("disabled"))});$(document).on("click",".delete",function(){$(this).parents("tr").find("td:not(:last-child)").each(function(){var n=$(this).text();n.includes("Bug")&&bugsList.splice(bugsList.indexOf($(this).text()),1);n.includes("Enhancement")&&enhancementsList.splice(enhancementsList.indexOf($(this).text()),1)});$(this).parents("tr").remove();$(".add-new").removeAttr("disabled")});$("#onlyMajorNumber").keypress(function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return $("#errmsg").html("only number allowed").show().fadeOut("slow"),!1;majorversionInput.test($("#onlyMajorNumber").val())||$("#errmsg").html("❌ Input between 1 to 10").show().fadeOut("slow");$("#onlyMajorNumber").val()<1&&$("#errmsg").html("❌ Negative values are not allowed").show().fadeOut("slow")});$("#onlyMinorNumber").keypress(function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return $("#errmsg").html("❌ only number allowed").show().fadeOut("slow"),!1;minorversionInput.test($("#onlyMajorNumber").val())||$("#errmsg").html("❌ Input between 1 to 20").show().fadeOut("slow");$("#onlyMinorNumber").val()<0&&$("#errmsg").html("❌ Negative values are not allowed").show().fadeOut("slow")});$("#btnSubmitServicePackDetails").click(function(){AddServicePackDetails()});$("#btnClose").click(function(){window.location.href="/Home/HomePage"});$("#btnReset").click(function(){$(":input","#frmAddEditServicePackDetails").each(function(){var n=this.type,t=this.tagName.toLowerCase();n=="text"||t=="textarea"||n=="file"?this.value="":t=="select"&&(this.selectedIndex=0);$("#onlyMajorNumber").val(" ");$("#onlyMinorNumber").val(" ")})});$("#lstReleaseTypes").change(function(){$("#lstReleaseTypes").val()==3?($("#rdoNFinal").attr("disabled","disabled"),$("#rdoYTest").attr("disabled","disabled"),$("#rdoNSupport").prop("checked",!0),$("#rdoNSupport").removeAttr("disabled")):($("#rdoNFinal").removeAttr("disabled"),$("#rdoYTest").removeAttr("disabled"),$("#rdoNSupport").attr("disabled","disabled"),$("#rdoNSupport").prop("checked",!1),$("#rdoYTest").prop("checked",!0))})});