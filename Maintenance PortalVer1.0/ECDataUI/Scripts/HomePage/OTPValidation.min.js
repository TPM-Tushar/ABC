function OpenCaptchaForVerification(n,t){$.ajax({type:"GET",url:"/Alerts/SendSMSDetails/VerifyCaptchaAfterRegistrationForOTP",data:{IsOTPSent:t,EncryptedUId:n,OTPTypeId:1},success:function(n){$("#divViewOTPValidationModal").modal({backdrop:"static",keyboard:!1});$("#divLoadOTPValidationView").html(" ");$("#divLoadOTPValidationView").html(n);$("#divViewOTPValidationModal").modal("show");$("#divCaptcha").show();$("#divOTPInput").hide();$("#btnCloseOTPModal").off("click").click(function(){$("#divViewOTPValidationModal").modal("hide")});$.unblockUI()},error:function(){$.unblockUI();bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured while processing your request<\/span>',callback:function(){}})}})}function refreshCaptcha(){$("#Captcha").val("");$("#dvCaptcha input").val("");$(".newCaptcha").trigger("click");$("#mydiv input").val("")}function BlockUI(){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",opacity:.5,color:"#fff"}})}var ResendOTPCounter=0,MaxValueForOTPAttempt=3,token="",header={};$(document).ready(function(){token=$("[name=__RequestVerificationToken]").val();header.__RequestVerificationToken=token;$("#divForMessageResendOTPAttempt").hide();$("#divViewOTPValidationModal").on("keypress",function(n){var t=n.keyCode?n.keyCode:n.which;t=="13"&&$("#btnValidateOTP").trigger("click")});$(".AllowOnlyNumber").keypress(function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return!1});$("#btnValidateOTP").click(function(){$("#OTPValidationFormId").valid()&&($("#divViewOTPValidationModal").modal("hide"),$.trim($("#OTPID").val())!=""&&$.ajax({url:"/Login/GetSessionSalt",type:"GET",async:!1,cache:!1,success:function(n){if(n.success&&n.dataMessage!=null){var t=n.dataMessage,i=hex_sha512($("#OTPID").val()),r=i+rstr2hex(t).toUpperCase(),u=hex_sha512(r);$("#OTPID").val(u);$.ajax({type:"POST",url:"/SendSMSDetails/ValidateOTP",headers:header,data:$("#OTPValidationFormId").serialize(),dataType:"json",success:function(n){n.success?bootbox.alert({message:'<i class="fa fa-check text-success boot-icon"><\/i><span class="boot-alert-txt">'+n.msg+"<\/span>",callback:function(){n.redirectToLoginPage&&(window.location.href=n.url)}}):n.msg==undefined?bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Something went wrong while processing your request .<\/span>',callback:function(){window.location.href="/Error/SessionExpire";$.unblockUI()}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.msg+"<\/span>",callback:function(){$("#divViewOTPValidationModal").modal("show");$("#OTPID").val("");$("#OTPID").focus()}})},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured while processing your request<\/span>',callback:function(){}})}})}},error:function(){bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured while processing your request<\/span>',callback:function(){}})}}))});$("#btnVerifyCaptcha").click(function(){BlockUI();$.ajax({type:"POST",url:"/Alerts/SendSMSDetails/VerifyCaptchaForOTP",headers:header,data:$("#OTPValidationFormId").serialize(),success:function(n){n.success?$.ajax({type:"GET",url:"/Alerts/SendSMSDetails/InputOTPFromUser",data:{IsOTPSent:n.IsOTPSent,OTPTypeId:n.OTPTypeId,EncryptedUId:n.EncryptedUId},success:function(n){n.success?($("#divViewOTPValidationModal").modal({backdrop:"static",keyboard:!1}),$("#divCaptcha").hide(),$("#divOTPInput").show(),$("#OTPID").focus(),$("#divForMessageResend").show(),$("#MobileNumbertoDisplayID").html(n.MobileNumberToDisplay),$("#btnCloseOTPModal").on("click").click(function(){$.unblockUI();$("#divViewOTPValidationModal").modal("hide")}),$.unblockUI()):n.message==undefined?bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Something went wrong while processing your request .<\/span>',callback:function(){window.location.href="/Error/SessionExpire";$.unblockUI()}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.message+"<\/span>",callback:function(){$("#divViewOTPValidationModal").modal("hide");$.unblockUI()}});$.unblockUI()},error:function(){$.unblockUI();bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Error occured while processing your request<\/span>',callback:function(){}})}}):bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">'+n.errorMessage+"<\/span>",callback:function(){refreshCaptcha();$("#divViewOTPValidationModal").modal("show");$("#divViewOTPValidationModal").css("display","block")}});$.unblockUI()},error:function(){$.unblockUI();bootbox.alert({message:'<i class="fa fa-exclamation-triangle text-danger boot-icon boot-icon"><\/i><span class="boot-alert-txt">Something went wrong while proccessing your request <\/span>',callback:function(){}})}})});$("#btnResendOTP").click(function(){refreshCaptcha();$("#divCaptcha").show();$("#divOTPInput").hide();$("#OTPID").focus();$.unblockUI()})});